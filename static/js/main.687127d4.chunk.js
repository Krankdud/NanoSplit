(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,n){e.exports=n(98)},44:function(e,t,n){},48:function(e,t,n){},50:function(e,t,n){},86:function(e,t,n){},88:function(e,t,n){},90:function(e,t,n){},92:function(e,t,n){},94:function(e,t,n){},96:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var s,i=n(0),a=n(33),r=n(2),o=n(6),l=n(13),c=(n(44),n(4)),m=function(){function e(){}return e.DIALOG_CLOSE_TIME_IN_MS=250,e.SKIPPED=-1,e.SPLITS_MARGIN=156,e.SPLIT_HEIGHT=34,e}();n(48);!function(e){e[e.Modal=0]="Modal",e[e.Fullscreen=1]="Fullscreen"}(s||(s={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lastDialogType=s.Modal,t}return r.b(t,e),t.prototype.render=function(){this.props.isOpen&&(this.lastDialogType=this.props.options.type);var e=this.lastDialogType===s.Modal?"dialog":"dialog-fullscreen",t=this.props.isOpen?"dialog-transition-active":"dialog-transition-inactive";return i.createElement("div",{className:t},this.props.options.type===s.Modal&&this.props.isOpen&&i.createElement("div",{className:"dialog-background"}),i.createElement("div",{className:e},i.createElement("div",{className:"dialog-header"},this.props.options.showCloseButton&&i.createElement("div",{className:"dialog-close",onClick:this.props.onClose},i.createElement(c.a,{icon:"times"})),this.props.options.title),i.createElement("div",{className:"dialog-content"},this.props.children),this.renderFooter()))},t.prototype.renderFooter=function(){var e,t;if(this.props.options.showConfirmButton||this.props.options.showCancelButton)return this.props.options.showCancelButton&&(e=i.createElement("span",{className:"dialog-footer-button",onClick:this.props.options.onCancel},"Cancel")),this.props.options.showConfirmButton&&(t=i.createElement("span",{className:"dialog-footer-button",onClick:this.props.options.onConfirm},"Confirm")),i.createElement("div",{className:"dialog-footer"},e,t)},t}(i.Component),u=n(16),d=(n(50),function(e){function t(t){var n=e.call(this,t)||this;n.lastId=0,n.handleSubmit=function(e){e.preventDefault(),n.props.onConfirm({category:n.state.category,delay:1e3*n.state.delay,game:n.state.game,segments:n.state.segments.slice()})},n.handleInputChange=function(e){var t=e.currentTarget,s=t.name,i=t.value;"game"===s?n.setState({game:i}):"category"===s?n.setState({category:i}):"delay"===s?n.setState({delay:parseInt(i,10)}):n.state.segments.forEach(function(e){e.id===s&&(e.title=i)})},n.onDragEnd=function(e){if(e.destination){var t=n.state.segments.slice(),s=t.splice(e.source.index,1)[0];t.splice(e.destination.index,0,s),n.setState({segments:t}),e.source.index===n.state.selectedIndex&&n.setState({selectedIndex:e.destination.index})}},n.onInsert=function(){n.lastId++;var e={id:"split-"+n.lastId,title:""},t=n.state.segments.slice();n.state.selectedIndex?t.splice(n.state.selectedIndex,0,e):t.push(e),n.setState({segments:t})},n.onRemove=function(){if(n.state.selectedIndex){var e=n.state.segments.slice();e.splice(n.state.selectedIndex,1),n.setState({segments:e,selectedIndex:void 0})}},n.makeDroppable=function(){for(var e=[],t=function(t){var s=n.state.segments[t].id,a="editsplits-split";n.state.selectedIndex===t&&(a+=" editsplits-split-selected"),e.push(i.createElement(u.b,{key:s,draggableId:s,index:t},function(e,o){return i.createElement("div",r.a({ref:e.innerRef},e.draggableProps,e.dragHandleProps,{className:a,onClick:function(){n.setState({selectedIndex:t})}}),i.createElement("input",{type:"text",name:s,defaultValue:n.state.segments[t].title,onChange:n.handleInputChange}),i.createElement("div",{className:"editsplits-split-sort"},i.createElement(c.a,{icon:"sort"})))}))},s=0;s<n.state.segments.length;s++)t(s);return i.createElement(u.c,{droppableId:"editSplitsDroppable"},function(t,n){return i.createElement("div",{ref:t.innerRef},e,t.placeholder)})};for(var s=t.run.segments.slice(),a=0;a<s.length;a++)s[a].id="split-"+a,n.lastId=a;return n.state={category:n.props.run.category,delay:Math.floor(n.props.run.delay/1e3),game:n.props.run.game,segments:s},n}return r.b(t,e),t.prototype.render=function(){return i.createElement("div",null,i.createElement("form",{onSubmit:this.handleSubmit},i.createElement("div",null,i.createElement("label",null,"Game"," ",i.createElement("input",{type:"text",name:"game",defaultValue:this.state.game,onChange:this.handleInputChange}))),i.createElement("div",null,i.createElement("label",null,"Category"," ",i.createElement("input",{type:"text",name:"category",defaultValue:this.state.category,onChange:this.handleInputChange}))),i.createElement("div",null,i.createElement("label",null,"Start delay (seconds)"," ",i.createElement("input",{type:"text",name:"delay",defaultValue:this.state.delay.toString(),onChange:this.handleInputChange}))),i.createElement("div",null,i.createElement("div",null,"Splits"),i.createElement(u.a,{onDragEnd:this.onDragEnd},this.makeDroppable())),i.createElement("div",{className:"editsplits-buttons"},i.createElement("span",{className:"editsplits-buttons-button",onClick:this.onRemove},"Remove"),i.createElement("span",{className:"editsplits-buttons-button",onClick:this.onInsert},"Insert"),i.createElement("input",{className:"editsplits-buttons-button",type:"submit",value:"Done"}))))},t}(i.Component));var g=function(e){var t=(new DOMParser).parseFromString(e,"application/xml");if(t.documentElement&&"parseerror"===t.documentElement.nodeName)throw Error(t.documentElement.childNodes[0].nodeValue||"Error parsing XML");var n=t.getElementsByTagName("Run")[0],s=n.getElementsByTagName("GameName")[0].childNodes[0].nodeValue,i=n.getElementsByTagName("CategoryName")[0].childNodes[0].nodeValue,a=n.getElementsByTagName("Offset")[0].childNodes[0].nodeValue,r=[];return Array.from(n.getElementsByTagName("Segments")[0].children).forEach(function(e){var t=e.getElementsByTagName("Name")[0].childNodes[0].nodeValue,n={realTime:e.getElementsByTagName("SplitTimes")[0].getElementsByTagName("RealTime")[0].childNodes[0].nodeValue},s={realTime:e.getElementsByTagName("BestSegmentTime")[0].getElementsByTagName("RealTime")[0].childNodes[0].nodeValue};r.push({bestSegmentTime:s,name:t,splitTimes:[n]})}),{category:i,game:s,offset:a,segments:r}},h=(n(86),function(e){function t(t){var n=e.call(this,t)||this;return n.handleSubmit=function(e){if(e.preventDefault(),n.fileInput.current&&n.fileInput.current.files){var t=new FileReader;t.readAsText(n.fileInput.current.files[0]),t.onload=function(e){var s=t.result;if("string"===typeof s)try{var i=g(s),a={category:i.category||"",delay:i.offset?n.convertLiveSplitTimeToMS(i.offset):0,game:i.game||"",segments:[]};i.segments.forEach(function(e){a.segments.push({bestTime:n.convertLiveSplitTimeToMS(e.bestSegmentTime.realTime),id:"",pbTime:n.convertLiveSplitTimeToMS(e.splitTimes[0].realTime),title:e.name||""})}),n.props.onImport(a)}catch(r){n.setState({errorOcurred:!0})}},t.onloadend=function(e){t.error&&n.setState({errorOcurred:!0})}}},n.convertLiveSplitTimeToMS=function(e){if(!e)return m.SKIPPED;var t=e.split(":"),n=Math.abs(parseInt(t[0],10)),s=parseInt(t[1],10),i=t[2].split("."),a=parseInt(i[0],10);return(i.length>1?parseInt(i[1].slice(0,3),10):0)+1e3*a+60*s*1e3+60*n*60*1e3},n.state={errorOcurred:!1},n.fileInput=i.createRef(),n}return r.b(t,e),t.prototype.render=function(){return i.createElement("div",null,this.state.errorOcurred&&i.createElement("div",{className:"import-error"},"An error occurred while reading the file. Please try again."),i.createElement("div",{className:"import-description"},"Import splits from ",i.createElement("a",{href:"https://www.livesplit.org"},"LiveSplit")),i.createElement("form",{onSubmit:this.handleSubmit},i.createElement("input",{type:"file",accept:".lss",ref:this.fileInput}),i.createElement("input",{type:"submit",value:"Import"})))},t}(i.Component)),f=(n(88),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.render=function(){var e=this.props.isOpen?"sidenav sidenav-active":"sidenav sidenav-inactive";return i.createElement("div",null,this.props.isOpen&&i.createElement("div",{className:"sidenav-background"}),i.createElement("div",{className:e},i.createElement("div",{className:"sidenav-close",onClick:this.props.closeCallback},i.createElement(c.a,{icon:"times"})),this.props.children))},t}(i.Component));n(90),n(92);function v(e,t){void 0===t&&(t=!0);var n=e<0?"-":"";e=Math.abs(e);var s=Math.floor(e/1e3),i=Math.floor(s/60),a=Math.floor(i/60);if(e=Math.round(e%1e3/10),i%=60,s%=60,t&&0===a&&0===i)n+=s+".",e<10&&(n+="0"),n+=e;else{var r=!1;a>0&&(r=!0,n+=a+":"),i>0?(i<10&&r&&(n+="0"),n+=i+":"):n+=r?"00:":"0:",s<10&&(n+="0"),n+=s}return n}var T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getTimeString=function(){var e="-";if(t.props.totalTime===m.SKIPPED)e="-";else if(t.props.totalTime){if(t.props.segment.pbTime)e=((n=t.props.totalTime-t.props.segment.pbTime)>0?"+":"-")+v(Math.abs(n),!1);else e=v(t.props.totalTime,!1)}else if(t.props.segment.pbTime){var n;if(t.props.isCurrentSplit&&t.props.currentTime>t.props.segment.pbTime)e="+"+v(n=t.props.currentTime-t.props.segment.pbTime,!1);else e=v(t.props.segment.pbTime,!1)}return e},t.getSplitColor=function(){if(!t.props.isCurrentSplit&&!t.props.totalTime||t.props.totalTime===m.SKIPPED||!t.props.segment.pbTime)return"";if(t.props.segment.bestTime&&t.props.totalTime&&t.props.prevTotalTime&&t.props.prevTotalTime!==m.SKIPPED&&t.props.totalTime-t.props.prevTotalTime<t.props.segment.bestTime)return"best-segment";var e=t.props.totalTime||t.props.currentTime,n=e<t.props.segment.pbTime,s=n;return t.props.prevSegment&&t.props.prevSegment.pbTime&&t.props.prevSegment.pbTime!==m.SKIPPED&&t.props.prevTotalTime&&t.props.prevTotalTime!==m.SKIPPED&&(s=e-t.props.prevTotalTime<t.props.segment.pbTime-t.props.prevSegment.pbTime),n?!t.props.totalTime&&s?"":s?"ahead-gaining-time":"ahead-losing-time":s?"behind-gaining-time":"behind-losing-time"},t}return r.b(t,e),t.prototype.render=function(){var e="split";return this.props.isCurrentSplit&&(e+=" split-active"),i.createElement("div",{className:e},i.createElement("span",{className:"split-title"},this.props.segment.title),i.createElement("span",{className:"split-time "+this.getSplitColor()},this.getTimeString()))},t}(i.Component),E=(n(94),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.render=function(){var e=Math.floor(Math.abs(this.props.time)%1e3/10),t=".";return e<10&&(t+="0"),t+=e,i.createElement("div",{className:"timer"},i.createElement("span",null,v(this.props.time,!1)),i.createElement("span",{className:"timer-decimal"},t))},t}(i.Component));o.b.add(l.a,l.b,l.c);var S=function(e){function t(t){var n=e.call(this,t)||this;return n.onTap=function(){n.state.isTiming?n.splitTimer():n.startTimer(),n.setState({hasTapped:!0})},n.startTimer=function(){clearInterval(n.interval),n.setState({currentSplit:0,history:[{segmentTimes:[]}],isPaused:!1,isTiming:!0,startTime:Date.now()+n.state.run.delay}),n.createInterval(),n.scrollToSplit(0)},n.splitTimer=function(){if(!(n.state.isPaused||!n.state.isTiming||n.state.currentTime<0)){var e=n.state.currentSplit;n.setSegmentTime(n.state.currentTime),n.state.currentSplit>=n.state.run.segments.length-1?(clearInterval(n.interval),n.setState({isTiming:!1})):(e+=1,n.setState({currentSplit:e})),n.scrollToSplit(e)}},n.pauseTimer=function(){clearInterval(n.interval),n.setState({isPaused:!0})},n.resumeTimer=function(){var e=Date.now();n.setState({isPaused:!1,startTime:e-n.state.currentTime}),n.createInterval()},n.resetTimer=function(){clearInterval(n.interval),n.setState({currentSplit:0,currentTime:-n.state.run.delay,history:[{segmentTimes:[]}],isTiming:!1})},n.undoSegment=function(){0!==n.state.currentSplit&&n.state.isTiming&&n.setState({currentSplit:n.state.currentSplit-1,history:n.state.history.slice(0,n.state.currentSplit)})},n.skipSegment=function(){n.state.isTiming&&(n.setSegmentTime(m.SKIPPED),n.setState({currentSplit:n.state.currentSplit+1}))},n.createInterval=function(){n.interval=setInterval(function(){n.setState({currentTime:Date.now()-n.state.startTime})})},n.setSegmentTime=function(e){var t=n.state.currentSplit,s=n.state.history[t].segmentTimes.concat([e]);n.setState({history:n.state.history.concat([{segmentTimes:s}])})},n.scrollToSplit=function(e){if(null!==document.documentElement){var t=document.documentElement.clientHeight,s=document.getElementById("footer"),i=document.getElementById("splits");if(s&&i){var a=s.getBoundingClientRect().height,r=i.getBoundingClientRect().height,o=n.state.run.segments.length,l=m.SPLITS_MARGIN+r-(o-e-1)*m.SPLIT_HEIGHT-t+a;window.scrollTo({behavior:"smooth",left:0,top:l})}}},n.newSplits=function(){n.setState({run:{category:"",delay:0,game:"",segments:[]}}),n.closeDialog()},n.openNewSplits=function(){n.setState({dialog:{contents:i.createElement("div",null,"Are you sure you want to create new splits? Your previous splits will be erased."),options:{onCancel:n.closeDialog,onConfirm:n.newSplits,showCancelButton:!0,showCloseButton:!1,showConfirmButton:!0,title:"Create new splits",type:s.Modal}},showDialog:!0,showMenu:!1})},n.openEditSplits=function(){n.setState({dialog:{contents:i.createElement(d,{run:n.state.run,onConfirm:n.onRunEditted}),options:{showCloseButton:!0,title:"Edit splits",type:s.Fullscreen}},showDialog:!0,showMenu:!1})},n.openImport=function(){n.setState({dialog:{contents:i.createElement(h,{onImport:n.onRunEditted}),options:{showCloseButton:!0,title:"Import",type:s.Modal}},showDialog:!0,showMenu:!1})},n.onRunEditted=function(e){n.resetTimer(),n.setState({currentTime:-e.delay,run:e}),n.closeDialog()},n.closeDialog=function(){n.setState({showDialog:!1}),window.setTimeout(function(){n.setState({dialog:{options:{showCloseButton:!0,title:"",type:s.Modal}}})},m.DIALOG_CLOSE_TIME_IN_MS)},n.openMenu=function(){n.setState({showMenu:!0})},n.closeMenu=function(){n.setState({showMenu:!1})},n.state={currentSplit:0,currentTime:0,dialog:{options:{showCloseButton:!0,title:"",type:s.Modal}},hasTapped:!1,history:[{segmentTimes:[]}],isPaused:!1,isTiming:!1,run:{category:"",delay:0,game:"",segments:[]},showDialog:!1,showMenu:!1,startTime:Date.now()},n}return r.b(t,e),t.prototype.componentWillUnmount=function(){clearInterval(this.interval)},t.prototype.render=function(){var e="Start",t=this.startTimer;this.state.isTiming&&(this.state.isPaused?(e="Resume",t=this.resumeTimer):(e="Pause",t=this.pauseTimer));for(var n,s=[],a=0;a<this.state.run.segments.length;a++)s.push(i.createElement(T,{key:a,segment:this.state.run.segments[a],currentTime:this.state.currentTime,isCurrentSplit:this.state.isTiming&&this.state.currentSplit===a,prevSegment:this.state.run.segments[a-1],prevTotalTime:this.state.history[this.state.currentSplit].segmentTimes[a-1],totalTime:this.state.history[this.state.currentSplit].segmentTimes[a]}));return n=""===this.state.run.game&&""===this.state.run.category?i.createElement("div",{className:"title title-large"},"NanoSplit"):""===this.state.run.game?i.createElement("div",{className:"title title-large"},this.state.run.category):""===this.state.run.category?i.createElement("div",{className:"title title-large"},this.state.run.game):i.createElement("div",{className:"title"},this.state.run.game,i.createElement("br",null),this.state.run.category),i.createElement("div",{className:"App"},i.createElement("div",{className:"clickable",onClick:this.onTap}),i.createElement("div",{className:"header"},i.createElement("div",{className:"title-bar"},i.createElement("div",{className:"sidenav-menu",onClick:this.openMenu},i.createElement(c.a,{icon:"bars"})),n),i.createElement("div",{onClick:this.onTap},i.createElement(E,{time:this.state.currentTime}))),i.createElement("div",{className:"splits",id:"splits",onClick:this.onTap},s),i.createElement("div",{id:"footer",className:"footer"},i.createElement("div",{className:"controls"},i.createElement("button",{className:"controls-button ml-0",onClick:this.undoSegment},"Undo"),i.createElement("button",{className:"controls-button",onClick:this.skipSegment},"Skip"),i.createElement("button",{className:"controls-button",onClick:this.resetTimer},"Reset"),i.createElement("button",{className:"controls-button mr-0",onClick:t},e)),i.createElement("div",{className:this.state.hasTapped?"tap-hint tap-hint-done":"tap-hint"},"Tap anywhere to start/split the timer")),i.createElement(f,{isOpen:this.state.showMenu,closeCallback:this.closeMenu},i.createElement("div",{className:"sidenav-item",onClick:this.openNewSplits},"New splits"),i.createElement("div",{className:"sidenav-item",onClick:this.openEditSplits},"Edit splits"),i.createElement("div",{className:"sidenav-item",onClick:this.openImport},"Import"),i.createElement("div",{className:"sidenav-item"},"Export"),i.createElement("div",{className:"sidenav-item"},"Settings")),i.createElement(p,{isOpen:this.state.showDialog,onClose:this.closeDialog,options:this.state.dialog.options},this.state.dialog.contents))},t}(i.Component),y=(n(96),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function b(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a.render(i.createElement(S,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/NanoSplit",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="/NanoSplit/service-worker.js";y?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):b(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):b(e)})}}()}},[[39,2,1]]]);
//# sourceMappingURL=main.687127d4.chunk.js.map